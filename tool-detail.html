<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading... | AI Image Hub</title>
    <meta name="description" content="Discover AI image tools - features, pricing, and reviews.">

    <!-- Open Graph -->
    <meta property="og:title" content="AI Image Tool | AI Image Hub">
    <meta property="og:description" content="Discover AI image tools - features, pricing, and reviews.">
    <meta property="og:image" content="https://aiimagetools.io/images/og-image.svg">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://aiimagetools.io/images/twitter-card.svg">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">

    <!-- CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/custom.css">
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <a href="/">
                            <i class="fas fa-palette text-purple-600 text-2xl mr-2"></i>
                            <span class="text-xl font-bold text-gray-900">AI Image Hub</span>
                        </a>
                    </div>
                    <div class="hidden sm:ml-8 sm:flex sm:space-x-8">
                        <a href="/tools.html" class="text-gray-700 hover:text-purple-600 px-3 py-2 text-sm font-medium">Tools</a>
                        <a href="/categories.html" class="text-gray-700 hover:text-purple-600 px-3 py-2 text-sm font-medium">Categories</a>
                        <a href="/comparisons.html" class="text-gray-700 hover:text-purple-600 px-3 py-2 text-sm font-medium">Comparisons</a>
                        <a href="/blog.html" class="text-gray-700 hover:text-purple-600 px-3 py-2 text-sm font-medium">Blog</a>
                    </div>
                </div>
                <!-- Mobile menu button -->
                <div class="flex items-center sm:hidden">
                    <button id="mobileMenuBtn" class="text-gray-700 hover:text-purple-600 p-2">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile menu -->
        <div id="mobileMenu" class="hidden sm:hidden bg-white border-t">
            <div class="px-4 py-2 space-y-1">
                <a href="/tools.html" class="block px-3 py-2 text-gray-700 hover:text-purple-600">Tools</a>
                <a href="/categories.html" class="block px-3 py-2 text-gray-700 hover:text-purple-600">Categories</a>
                <a href="/comparisons.html" class="block px-3 py-2 text-gray-700 hover:text-purple-600">Comparisons</a>
                <a href="/blog.html" class="block px-3 py-2 text-gray-700 hover:text-purple-600">Blog</a>
            </div>
        </div>
    </nav>

    <!-- Breadcrumb -->
    <div class="bg-white border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
            <nav class="text-sm" id="breadcrumb">
                <a href="/" class="text-gray-500 hover:text-gray-700">Home</a>
                <span class="mx-2 text-gray-400">/</span>
                <a href="/tools.html" class="text-gray-500 hover:text-gray-700">Tools</a>
                <span class="mx-2 text-gray-400">/</span>
                <span class="text-gray-900" id="breadcrumbToolName">Loading...</span>
            </nav>
        </div>
    </div>

    <!-- Loading State -->
    <div id="loadingState" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="animate-pulse">
            <div class="bg-white rounded-xl shadow-sm p-8 mb-6">
                <div class="flex items-center">
                    <div class="w-20 h-20 bg-gray-200 rounded-xl"></div>
                    <div class="ml-4">
                        <div class="h-8 bg-gray-200 rounded w-48 mb-2"></div>
                        <div class="h-4 bg-gray-200 rounded w-32"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Error State -->
    <div id="errorState" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center">
        <i class="fas fa-exclamation-triangle text-6xl text-gray-300 mb-4"></i>
        <h2 class="text-2xl font-bold text-gray-700 mb-2">Tool Not Found</h2>
        <p class="text-gray-500 mb-6">The tool you're looking for doesn't exist or has been removed.</p>
        <a href="/tools.html" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition">
            Browse All Tools
        </a>
    </div>

    <!-- Main Content (hidden until loaded) -->
    <main id="mainContent" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid lg:grid-cols-3 gap-8">
            <!-- Main Content Column -->
            <div class="lg:col-span-2">
                <!-- Tool Header -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-6">
                    <div class="flex items-start justify-between mb-6">
                        <div class="flex items-center">
                            <img id="toolLogo" src="" alt="" class="w-20 h-20 rounded-xl">
                            <div class="ml-4">
                                <h1 id="toolName" class="text-3xl font-bold text-gray-900"></h1>
                                <p id="toolCategory" class="text-gray-600 mt-1"></p>
                                <div class="flex items-center mt-2">
                                    <div id="toolRating" class="flex text-yellow-400"></div>
                                    <span id="toolReviews" class="ml-2 text-gray-600"></span>
                                </div>
                            </div>
                        </div>
                        <div id="toolBadges" class="flex flex-col items-end gap-2"></div>
                    </div>
                    <p id="toolDescription" class="text-gray-700 text-lg leading-relaxed"></p>
                </div>

                <!-- Tags -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Tags</h2>
                    <div id="toolTags" class="flex flex-wrap gap-2"></div>
                </div>

                <!-- Pricing -->
                <div class="bg-white rounded-xl shadow-sm p-8 mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Pricing</h2>
                    <div id="pricingInfo" class="text-lg"></div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="lg:col-span-1">
                <!-- Quick Actions -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-6 sticky top-24">
                    <a id="visitToolBtn" href="#" target="_blank" class="block w-full bg-purple-600 text-white text-center py-3 rounded-lg font-medium hover:bg-purple-700 transition mb-3">
                        Visit Tool <i class="fas fa-external-link-alt ml-2"></i>
                    </a>
                    <button onclick="navigator.share ? navigator.share({title: document.title, url: window.location.href}) : alert('Copy this URL: ' + window.location.href)" class="w-full border border-gray-300 text-gray-700 py-3 rounded-lg font-medium hover:bg-gray-50 transition">
                        <i class="fas fa-share-alt mr-2"></i> Share
                    </button>
                </div>

                <!-- Tool Details -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
                    <h3 class="font-semibold text-lg mb-4">Tool Details</h3>
                    <dl class="space-y-3">
                        <div>
                            <dt class="text-gray-500 text-sm">Category</dt>
                            <dd id="detailCategory" class="font-medium"></dd>
                        </div>
                        <div>
                            <dt class="text-gray-500 text-sm">Pricing Model</dt>
                            <dd id="detailPricing" class="font-medium"></dd>
                        </div>
                        <div>
                            <dt class="text-gray-500 text-sm">Rating</dt>
                            <dd id="detailRating" class="font-medium"></dd>
                        </div>
                        <div>
                            <dt class="text-gray-500 text-sm">Reviews</dt>
                            <dd id="detailReviews" class="font-medium"></dd>
                        </div>
                    </dl>
                </div>

                <!-- Similar Tools -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="font-semibold text-lg mb-4">Similar Tools</h3>
                    <div id="similarTools" class="space-y-4"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-300 py-12 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center text-sm">
                <p>&copy; 2024 AI Image Hub. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        document.getElementById('mobileMenuBtn').addEventListener('click', function() {
            document.getElementById('mobileMenu').classList.toggle('hidden');
        });

        // Get tool slug from URL
        function getToolSlug() {
            const path = window.location.pathname;
            const parts = path.split('/');
            return parts[parts.length - 1] || parts[parts.length - 2];
        }

        // Format number (e.g., 15420 -> 15.4k)
        function formatNumber(num) {
            if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'k';
            }
            return num.toString();
        }

        // Render rating stars
        function renderStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalf = rating % 1 >= 0.5;
            let html = '';
            for (let i = 0; i < fullStars; i++) {
                html += '<i class="fas fa-star"></i>';
            }
            if (hasHalf) {
                html += '<i class="fas fa-star-half-alt"></i>';
            }
            const empty = 5 - fullStars - (hasHalf ? 1 : 0);
            for (let i = 0; i < empty; i++) {
                html += '<i class="far fa-star"></i>';
            }
            return html;
        }

        // Format pricing
        function formatPricing(pricing) {
            switch(pricing) {
                case 'free': return 'Free';
                case 'freemium': return 'Freemium';
                case 'paid': return 'Paid';
                default: return pricing;
            }
        }

        // Get pricing badge class
        function getPricingBadgeClass(pricing) {
            switch(pricing) {
                case 'free': return 'bg-green-100 text-green-800';
                case 'freemium': return 'bg-blue-100 text-blue-800';
                case 'paid': return 'bg-purple-100 text-purple-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        // Load tool data
        async function loadTool() {
            const slug = getToolSlug();

            try {
                const response = await fetch(`/api/tools/slug/${slug}`);

                if (!response.ok) {
                    throw new Error('Tool not found');
                }

                const tool = await response.json();

                // Update page title
                document.title = `${tool.name} - AI Image Tool | AI Image Hub`;

                // Update breadcrumb
                document.getElementById('breadcrumbToolName').textContent = tool.name;

                // Update tool header
                document.getElementById('toolLogo').src = '/' + tool.logo;
                document.getElementById('toolLogo').alt = tool.name + ' Logo';
                document.getElementById('toolName').textContent = tool.name;
                document.getElementById('toolCategory').textContent = tool.category;
                document.getElementById('toolRating').innerHTML = renderStars(tool.rating);
                document.getElementById('toolReviews').textContent = `${tool.rating}/5 (${formatNumber(tool.reviews)} reviews)`;
                document.getElementById('toolDescription').textContent = tool.description;

                // Update badges
                const badgesContainer = document.getElementById('toolBadges');
                badgesContainer.innerHTML = '';
                if (tool.featured) {
                    badgesContainer.innerHTML += '<span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">Featured</span>';
                }
                if (tool.popularity > 90) {
                    badgesContainer.innerHTML += '<span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">Popular</span>';
                }

                // Update tags
                const tagsContainer = document.getElementById('toolTags');
                tagsContainer.innerHTML = tool.tags.map(tag =>
                    `<span class="bg-gray-100 text-gray-700 px-4 py-2 rounded-full">${tag}</span>`
                ).join('');

                // Update pricing
                const pricingInfo = document.getElementById('pricingInfo');
                pricingInfo.innerHTML = `
                    <span class="inline-block ${getPricingBadgeClass(tool.pricing)} px-4 py-2 rounded-full text-lg font-medium">
                        ${formatPricing(tool.pricing)}
                    </span>
                `;

                // Update visit button
                document.getElementById('visitToolBtn').href = tool.url;

                // Update sidebar details
                document.getElementById('detailCategory').textContent = tool.category;
                document.getElementById('detailPricing').textContent = formatPricing(tool.pricing);
                document.getElementById('detailRating').textContent = `${tool.rating}/5`;
                document.getElementById('detailReviews').textContent = formatNumber(tool.reviews);

                // Update similar tools
                const similarContainer = document.getElementById('similarTools');
                if (tool.similar_tools && tool.similar_tools.length > 0) {
                    similarContainer.innerHTML = tool.similar_tools.map(t => {
                        const tSlug = t.name.toLowerCase().replace(/\s+/g, '-').replace(/\./g, '-');
                        return `
                            <a href="/tools/${tSlug}" class="block hover:bg-gray-50 p-3 rounded-lg transition">
                                <div class="flex items-center">
                                    <img src="/${t.logo}" alt="${t.name}" class="w-10 h-10 rounded-lg" onerror="this.src='https://via.placeholder.com/40?text=${t.name.charAt(0)}'">
                                    <div class="ml-3">
                                        <h4 class="font-medium">${t.name}</h4>
                                        <p class="text-sm text-gray-500">${t.category}</p>
                                    </div>
                                </div>
                            </a>
                        `;
                    }).join('');
                } else {
                    similarContainer.innerHTML = '<p class="text-gray-500 text-sm">No similar tools found.</p>';
                }

                // Show content, hide loading
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('mainContent').classList.remove('hidden');

            } catch (error) {
                console.error('Error loading tool:', error);
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('errorState').classList.remove('hidden');
            }
        }

        // Load on page ready
        document.addEventListener('DOMContentLoaded', loadTool);
    </script>
</body>
</html>
